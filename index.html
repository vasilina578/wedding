<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –Ω–∞ –Ω–∞—à—É —Å–≤–∞–¥—å–±—É</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@300;400;500;600&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header>
            <h1>–î–æ—Ä–æ–≥–∏–µ –≥–æ—Å—Ç–∏!</h1>
            <p class="subtitle">–ú—ã —Ä–∞–¥—ã –ø—Ä–∏–≥–ª–∞—Å–∏—Ç—å –≤–∞—Å –Ω–∞ –ø—Ä–∞–∑–¥–Ω–æ–≤–∞–Ω–∏–µ –Ω–∞—à–µ–≥–æ —Å–≤–∞–¥—å–±—ã!</p>
            <div class="couple-names">
                <span>–ê–Ω–Ω–∞</span>
                <i class="fas fa-heart"></i>
                <span>–ò–≤–∞–Ω</span>
            </div>
            <p class="date">15 –∏—é–ª—è 2024 –≥–æ–¥–∞</p>
        </header>

        <section class="form-section">
            <h2>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–≤–æ—ë –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ –∏ –≤—ã–±–æ—Ä –Ω–∞–ø–∏—Ç–∫–æ–≤ –¥–æ 1 –∏—é–ª—è</h2>
            
            <!-- –û—Å–Ω–æ–≤–Ω–æ–π –≥–æ—Å—Ç—å -->
            <div class="guest-section">
                <h3>–û—Å–Ω–æ–≤–Ω–æ–π –≥–æ—Å—Ç—å</h3>
                <div class="form-group">
                    <label for="name">–í–∞—à–µ –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—è *</label>
                    <input type="text" id="name" required>
                </div>

                <div class="form-group">
                    <label>–í—ã–±–µ—Ä–∏—Ç–µ –Ω–∞–ø–∏—Ç–∫–∏ (–º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ):</label>
                    <div class="checkbox-group" id="mainAlcoholGroup">
                        <label class="checkbox-label">
                            <input type="checkbox" value="–ö—Ä–∞—Å–Ω–æ–µ –≤–∏–Ω–æ">
                            <span class="checkmark"></span>
                            –ö—Ä–∞—Å–Ω–æ–µ –≤–∏–Ω–æ
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" value="–ë–µ–ª–æ–µ –≤–∏–Ω–æ">
                            <span class="checkmark"></span>
                            –ë–µ–ª–æ–µ –≤–∏–Ω–æ
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" value="–®–∞–º–ø–∞–Ω—Å–∫–æ–µ">
                            <span class="checkmark"></span>
                            –®–∞–º–ø–∞–Ω—Å–∫–æ–µ
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" value="–í–∏—Å–∫–∏">
                            <span class="checkmark"></span>
                            –í–∏—Å–∫–∏
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" value="–í–æ–¥–∫–∞">
                            <span class="checkmark"></span>
                            –í–æ–¥–∫–∞
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" value="–ö–æ–Ω—å—è–∫">
                            <span class="checkmark"></span>
                            –ö–æ–Ω—å—è–∫
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" value="–ù–µ –ø—å—é –∞–ª–∫–æ–≥–æ–ª—å">
                            <span class="checkmark"></span>
                            –ù–µ –ø—å—é –∞–ª–∫–æ–≥–æ–ª—å
                        </label>
                    </div>
                </div>
            </div>

            <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≥–æ—Å—Ç–∏ -->
            <div id="additionalGuests">
                <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≥–æ—Å—Ç–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –∑–¥–µ—Å—å -->
            </div>

            <!-- –ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≥–æ—Å—Ç—è -->
            <div class="form-group">
                <button type="button" id="addGuestBtn" class="add-guest-btn">
                    <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –µ—â—ë –≥–æ—Å—Ç—è
                </button>
            </div>

            <button type="button" id="submitBtn" class="submit-btn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ –æ—Ç–≤–µ—Ç—ã</button>
            
            <div id="formMessage" style="display: none; margin-top: 20px; padding: 10px; border-radius: 5px; text-align: center;"></div>
        </section>
    </div>

    <script>
        const BOT_TOKEN = '8044113138:AAGY9F1YVBXbyKrqX_wXGsnn42IYYm0YAJ0';
        const CHAT_ID = '409598781';
        let guestCount = 0;

        // –§—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≥–æ—Å—Ç—è
        document.getElementById('addGuestBtn').addEventListener('click', function() {
            guestCount++;
            const newGuest = document.createElement('div');
            newGuest.className = 'guest-section';
            newGuest.innerHTML = `
                <h3>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –≥–æ—Å—Ç—å ${guestCount}</h3>
                <button type="button" class="remove-guest-btn" onclick="this.parentElement.remove()">
                    <i class="fas fa-times"></i> –£–¥–∞–ª–∏—Ç—å
                </button>
                <div class="form-group">
                    <label>–ò–º—è –∏ —Ñ–∞–º–∏–ª–∏—è</label>
                    <input type="text" id="guest${guestCount}_name" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—é">
                </div>
                <div class="form-group">
                    <label>–í—ã–±–µ—Ä–∏—Ç–µ –Ω–∞–ø–∏—Ç–∫–∏:</label>
                    <div class="checkbox-group" id="guest${guestCount}_alcohol">
                        <label class="checkbox-label">
                            <input type="checkbox" value="–ö—Ä–∞—Å–Ω–æ–µ –≤–∏–Ω–æ">
                            <span class="checkmark"></span>
                            –ö—Ä–∞—Å–Ω–æ–µ –≤–∏–Ω–æ
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" value="–ë–µ–ª–æ–µ –≤–∏–Ω–æ">
                            <span class="checkmark"></span>
                            –ë–µ–ª–æ–µ –≤–∏–Ω–æ
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" value="–®–∞–º–ø–∞–Ω—Å–∫–æ–µ">
                            <span class="checkmark"></span>
                            –®–∞–º–ø–∞–Ω—Å–∫–æ–µ
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" value="–í–∏—Å–∫–∏">
                            <span class="checkmark"></span>
                            –í–∏—Å–∫–∏
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" value="–í–æ–¥–∫–∞">
                            <span class="checkmark"></span>
                            –í–æ–¥–∫–∞
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" value="–ö–æ–Ω—å—è–∫">
                            <span class="checkmark"></span>
                            –ö–æ–Ω—å—è–∫
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" value="–ù–µ –ø—å—é –∞–ª–∫–æ–≥–æ–ª—å">
                            <span class="checkmark"></span>
                            –ù–µ –ø—å—é –∞–ª–∫–æ–≥–æ–ª—å
                        </label>
                    </div>
                </div>
            `;
            document.getElementById('additionalGuests').appendChild(newGuest);
        });

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –Ω–∞–ø–∏—Ç–∫–æ–≤
        function getSelectedAlcohol(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return [];
            const checkboxes = container.querySelectorAll('input[type="checkbox"]:checked');
            return Array.from(checkboxes).map(cb => cb.value);
        }

        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram —á–µ—Ä–µ–∑ CORS –ø—Ä–æ–∫—Å–∏
        async function sendToTelegram(message) {
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º CORS –ø—Ä–æ–∫—Å–∏ –¥–ª—è –æ–±—Ö–æ–¥–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –±—Ä–∞—É–∑–µ—Ä–∞
            const proxyUrl = 'https://cors-anywhere.herokuapp.com/';
            const telegramUrl = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;
            
            try {
                const response = await fetch(proxyUrl + telegramUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Requested-With': 'XMLHttpRequest'
                    },
                    body: JSON.stringify({
                        chat_id: CHAT_ID,
                        text: message,
                        parse_mode: 'HTML'
                    })
                });
                
                const result = await response.json();
                console.log('–†–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏:', result);
                return result.ok;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram:', error);
                
                // –ü—Ä–æ–±—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø—Ä–æ–∫—Å–∏
                try {
                    const altResponse = await fetch(`https://api.codetabs.com/v1/proxy?quest=${encodeURIComponent(telegramUrl)}`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            chat_id: CHAT_ID,
                            text: message,
                            parse_mode: 'HTML'
                        })
                    });
                    
                    const altResult = await altResponse.json();
                    return altResult.ok;
                } catch (altError) {
                    console.error('–û—à–∏–±–∫–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–æ–∫—Å–∏:', altError);
                    return false;
                }
            }
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏
        document.getElementById('submitBtn').addEventListener('click', async function() {
            const submitButton = this;
            const messageDiv = document.getElementById('formMessage');
            const name = document.getElementById('name').value;

            if (!name) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—é');
                return;
            }

            submitButton.textContent = '–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è...';
            submitButton.disabled = true;

            // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –≥–æ—Å—Ç—è
            const mainAlcohol = getSelectedAlcohol('mainAlcoholGroup');
            
            // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –≥–æ—Å—Ç–µ–π
            const additionalGuests = [];
            for (let i = 1; i <= guestCount; i++) {
                const guestNameInput = document.getElementById(`guest${i}_name`);
                if (guestNameInput && guestNameInput.value.trim() !== '') {
                    const guestAlcohol = getSelectedAlcohol(`guest${i}_alcohol`);
                    additionalGuests.push({
                        name: guestNameInput.value,
                        alcohol: guestAlcohol
                    });
                }
            }

            // –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è Telegram
            let message = `<b>üéâ –ù–æ–≤—ã–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ!</b>\n\n`;
            message += `<b>üë§ –û—Å–Ω–æ–≤–Ω–æ–π –≥–æ—Å—Ç—å:</b> ${name}\n`;
            message += `<b>üç∑ –ù–∞–ø–∏—Ç–∫–∏:</b> ${mainAlcohol.length > 0 ? mainAlcohol.join(', ') : '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}\n\n`;

            if (additionalGuests.length > 0) {
                message += `<b>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≥–æ—Å—Ç–∏:</b>\n\n`;
                additionalGuests.forEach((guest, index) => {
                    message += `<b>üë• –ì–æ—Å—Ç—å ${index + 1}:</b> ${guest.name}\n`;
                    message += `<b>üç∑ –ù–∞–ø–∏—Ç–∫–∏:</b> ${guest.alcohol.length > 0 ? guest.alcohol.join(', ') : '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}\n\n`;
                });
            } else {
                message += `<b>üë• –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –≥–æ—Å—Ç–µ–π –Ω–µ—Ç</b>\n\n`;
            }

            message += `<b>üìä –í—Å–µ–≥–æ –≥–æ—Å—Ç–µ–π:</b> ${1 + additionalGuests.length}`;

            console.log('–û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ:', message);

            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ Telegram
            const success = await sendToTelegram(message);

            if (success) {
                messageDiv.style.display = 'block';
                messageDiv.style.backgroundColor = '#d4edda';
                messageDiv.style.color = '#155724';
                messageDiv.textContent = '–°–ø–∞—Å–∏–±–æ! –í—Å–µ –æ—Ç–≤–µ—Ç—ã —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã. –ñ–¥—ë–º –≤–∞—Å –Ω–∞ –ø—Ä–∞–∑–¥–Ω–∏–∫–µ!';
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É
                document.getElementById('name').value = '';
                
                // –°–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å —á–µ–∫–±–æ–∫—Å–æ–≤
                const allCheckboxes = document.querySelectorAll('input[type="checkbox"]');
                allCheckboxes.forEach(checkbox => {
                    checkbox.checked = false;
                });
                
                // –û—á–∏—â–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –≥–æ—Å—Ç–µ–π
                document.getElementById('additionalGuests').innerHTML = '';
                guestCount = 0;
            } else {
                messageDiv.style.display = 'block';
                messageDiv.style.backgroundColor = '#f8d7da';
                messageDiv.style.color = '#721c24';
                messageDiv.textContent = '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.';
            }

            submitButton.textContent = '–û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ –æ—Ç–≤–µ—Ç—ã';
            submitButton.disabled = false;
        });
    </script>
</body>
</html>